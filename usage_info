This is a simple demo for searchable encryption scheme.

Pre-requisite:
execute command ./INSTALL_PACKAGES.sh to install packages required for this program.



Add new Rules:
To add new rules, update Rule_List.txt file. Every line in the file corresponds to one rule. 



Execution:
!To run both the programs execute the given commands:
$python sampleclient.py
$python samplemiddlebox.py

Both programs will start by opening their own GUI

Step 1:
In samplemiddlebox.py program, Select whether you want to keep malware analysis feature OFF/ON. 
Press the start button to start middlebox process.(Make sure port number 44440 and 44448 are available)

Step 2:
In sampleclient.py program, enter the URL you want to communicate with in the given format:
www.<WEBSITE_NAME>
eg. www.python.org
www.bbc.co.uk

Enter the ip address of the middlebox machine. 
Port number is hard coded into the program. So it cannot be changed but it is displayed on the UI.

Press the URL button to start the communication.

Step 3:
If the traffic was not malicious then you can see the response page text from the desired server in the new text field. Also, you will be able to observe the time needed to receive response in seconds.
If the traffic was malicious then you see an error message in the textbox "MALWARE FOUND ERROR". This error message is sent from middlebox.

Step 4:
To observe the working of middlebox, press button "Show Traffic". Middlebox will display the traffic in one of the textbox and Rules that were being checked in other.



Tip- If there are any issues shown on the command prompt such as socket error/Socket Timeout/Connection Refused, then start the middlebox process by executing $python samplemiddlebox.py and press the button close.
______________________________________________________________________________________________________________________________________________________________

